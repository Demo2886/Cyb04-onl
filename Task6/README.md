<details>
<summary><b>1. Этапы, методы и протоколы IPSec фреймворка</b></summary>

**IPSec (Internet Protocol Security)** — это набор протоколов для защиты IP-сетей путем аутентификации и шифрования каждого IP-пакета в сессии. IPSec работает на сетевом уровне и обеспечивает защиту данных между двумя узлами.

#### IKE Phase 1

**IKE (Internet Key Exchange) Phase 1** используется для аутентификации и установления защищенного канала между двумя сторонами. Этот этап включает следующие ключевые моменты:

- **Цели**: Установить защищенный канал для обмена ключами и аутентификации.
- **Методы аутентификации**: Используются различные методы, включая предустановленные ключи, сертификаты и аутентификацию по паролю (PSK).
- **Режимы**:
  - **Main Mode**: Более защищенный режим, использующий 6 сообщений для завершения аутентификации.
  - **Aggressive Mode**: Более быстрый, использующий 3 сообщения, но менее безопасный.

#### IKE Phase 2

**IKE Phase 2** используется для установки и управления защищенными соединениями для передачи данных. Этот этап включает:

- **Цели**: Установить параметры безопасности для IPSec-соединения.
- **Протоколы**: Используются протоколы ESP (Encapsulating Security Payload) и AH (Authentication Header).
- **Механизмы**: Установление параметров шифрования и аутентификации, а также обмен ключами для сеансовой безопасности.

#### Протоколы фреймворка IPSec

Основные протоколы IPSec включают:

1. **AH (Authentication Header)**: Обеспечивает аутентификацию и целостность данных, но не шифрует их.
2. **ESP (Encapsulating Security Payload)**: Обеспечивает как шифрование, так и аутентификацию, что делает его более распространенным выбором для защиты данных.
3. **IKE (Internet Key Exchange)**: Протокол для обмена ключами и управления безопасностью.

### HTTP vs HTTPS

- **HTTP (Hypertext Transfer Protocol)**: Протокол для передачи данных в интернете. Он не обеспечивает шифрование, что делает данные уязвимыми для перехвата.

- **HTTPS (HTTP Secure)**: Расширение HTTP, использующее SSL/TLS для шифрования данных между клиентом и сервером. Это обеспечивает конфиденциальность и целостность передаваемой информации, защищая её от атак, таких как "человек посередине".

### Заключение

IPSec предоставляет мощные средства для защиты сетевых соединений, а IKE обеспечивает безопасный обмен ключами. Понимание различий между HTTP и HTTPS также критично для обеспечения безопасности данных в веб-приложениях.

## Описание нескольких лучших практик по использованию SSH (Secure Shell):

1. **Используйте ключи SSH вместо паролей**: Генерация пары ключей (публичный и приватный) обеспечивает более высокий уровень безопасности по сравнению с паролями.

2. **Отключите вход по паролю**: После настройки ключей SSH отключите возможность входа по паролю, чтобы предотвратить атаки методом подбора.

3. **Измените стандартный порт SSH**: По умолчанию SSH работает на порту 22. Изменение порта может снизить количество автоматических атак.

4. **Используйте брандмауэр**: Настройте брандмауэр для ограничения доступа к вашему SSH-серверу только с определённых IP-адресов.

5. **Регулярно обновляйте программное обеспечение**: Убедитесь, что ваш SSH-сервер и клиент всегда обновлены до последних версий для защиты от уязвимостей.

6. **Настройте двухфакторную аутентификацию (2FA)**: Это добавляет дополнительный уровень защиты к вашему SSH-доступу.

7. **Ограничьте доступ пользователей**: Создайте группы пользователей и предоставьте доступ только тем, кто действительно нуждается в нём.

8. **Используйте `Fail2Ban` или аналогичные инструменты**: Эти инструменты могут заблокировать IP-адреса после нескольких неудачных попыток входа.

9. **Мониторинг и аудит**: Ведите журналы входа и регулярно проверяйте их на предмет подозрительной активности.

10. **Регулярно меняйте ключи**: Периодическая замена ключей SSH помогает предотвратить несанкционированный доступ.

Следуя этим рекомендациям, вы можете значительно повысить безопасность вашего SSH-доступа.
</details>

<details>
<summary><b>2. Пошаговая инструкция по генерации SSH-ключей, их добавлению в ssh-agent и копированию на удалённый сервер с использованием SCP на Ubuntu.</b></summary>

### Шаг 1: Установка необходимых приложений

1. **Откройте терминал**.
2. Убедитесь, что у вас установлены OpenSSH. Выполните команду:

   ```bash
   sudo apt update
   sudo apt install openssh-client openssh-server
   ```

3. Проверьте, что SSH установлен:

   ```bash
   ssh -V
   ```

   Вы должны увидеть версию SSH.

### Шаг 2: Генерация SSH-ключей

1. Создайте директорию для хранения ключей, если она ещё не существует:

   ```bash
   mkdir -p ~/.ssh/tms
   ```

2. Сгенерируйте ключи с помощью команды `ssh-keygen`. Укажите путь к файлу для сохранения ключей:

   ```bash
   ssh-keygen -t rsa -b 4096 -f ~/.ssh/tms/id_rsa
   ```

   - `-t rsa` указывает тип ключа (RSA).
   - `-b 4096` задаёт длину ключа (4096 бит).
   - `-f ~/.ssh/tms/id_rsa` задаёт путь к файлу.

3. Вам будет предложено ввести пароль для ключа (необязательно, но рекомендуется для дополнительной безопасности). После этого ключи будут сгенерированы.

### Шаг 3: Проверка сгенерированных ключей

Проверьте, что ключи созданы:

```bash
ls ~/.ssh/tms/
```
![Image](/Task6/img/gen-ssh.png)

Вы должны увидеть файлы `id_rsa` (приватный ключ) и `id_rsa.pub` (публичный ключ).

### Шаг 4: Добавление приватного ключа в ssh-agent

1. Запустите ssh-agent:

   ```bash
   eval "$(ssh-agent -s)"
   ```

2. Добавьте ваш приватный ключ в ssh-agent:

   ```bash
   ssh-add ~/.ssh/tms/id_rsa
   ```

### Шаг 5: Копирование публичного ключа на удалённый сервер

1. Скопируйте публичный ключ на удалённый сервер с помощью команды `ssh-copy-id`. Замените `user` и `remote_host` на имя пользователя и адрес вашего удалённого сервера:

   ```bash
   ssh-copy-id -i ~/.ssh/tms/id_rsa.pub user@remote_host
   ```

   Вам будет предложено ввести пароль для удалённого пользователя.

![Image](/Task6/img/add-ssh-server.png)

2. После успешного выполнения этой команды, ваш публичный ключ будет добавлен в файл `~/.ssh/authorized_keys` на удалённом сервере.

### Шаг 6: Проверка подключения

Попробуйте подключиться к удалённому серверу с помощью SSH:

```bash
ssh user@remote_host
```

![Image](/Task6/img/connect-ssh.png)

Если всё настроено правильно, вы должны войти на сервер без запроса пароля (если вы не устанавливали пароль для ключа).

### Шаг 7: Использование SCP для копирования файлов

Теперь вы можете использовать SCP для копирования файлов на удалённый сервер. Например, чтобы скопировать файл `file.txt`:

```bash
scp file.txt user@remote_host:/path/to/destination/
```

### Заключение

Теперь вы успешно сгенерировали SSH-ключи, добавили их в ssh-agent и скопировали публичный ключ на удалённый сервер. Вы также узнали, как использовать SCP для передачи файлов.
</details>

<details>
<summary><b>3. Упросщение процесса подключения к SSH-серверу, вы можете настроить файл конфигурации SSH. Вот как это сделать:</b></summary>

### 1. Откройте файл конфигурации SSH

На вашем локальном компьютере (где вы хотите подключаться к серверу) откройте файл конфигурации SSH. Если он не существует, создайте его:

```bash
nano ~/.ssh/config
```

### 2. Добавьте настройки для вашего сервера

В файле `config` добавьте блок для вашего SSH-сервера. Пример конфигурации:

```plaintext
Host my-ubuntu-vm
    HostName your_ubuntu_vm_ip
    User yourusername
    Port 2222
    IdentityFile ~/.ssh/id_rsa
```
![Image](/Task6/img/ssh-conf.png)

#### Пояснение параметров:

- `Host`: Имя, под которым вы будете обращаться к серверу (можно выбрать любое).
- `HostName`: IP-адрес или доменное имя вашего Ubuntu VM.
- `User`: Имя пользователя, под которым вы будете подключаться.
- `Port`: Порт, на котором работает SSH (в вашем случае 22).
- `IdentityFile`: Путь к вашему приватному ключу (по умолчанию `~/.ssh/id_rsa`).

### 3. Сохраните изменения и закройте редактор

Если вы используете `nano`, нажмите `CTRL + X`, затем `Y` и `Enter`, чтобы сохранить изменения.

### 4. Установите права доступа к файлу конфигурации

Убедитесь, что файл конфигурации имеет правильные права доступа:

```bash
chmod 600 ~/.ssh/config
```

### 5. Подключение к серверу

Теперь вы можете подключиться к вашему серверу, просто используя имя, которое вы указали в `Host`:

```bash
ssh my-ubuntu-vm
```

### Примечания

- Если у вас есть несколько серверов, вы можете добавить для каждого отдельный блок в файл `config`.
- Убедитесь, что ваш SSH-ключ добавлен в ssh-agent, если вы используете его для аутентификации.

</details>

<details>
<summary><b>4. Настройка SSH на Ubuntu с учетом безопасности включает несколько важных шагов.</b></summary>

### 1. Установка SSH-сервера
Если SSH-сервер еще не установлен, выполните команду:

```bash
sudo apt update
sudo apt install openssh-server
```

### 2. Настройка конфигурации SSH
Откройте файл конфигурации SSH:

```bash
sudo nano /etc/ssh/sshd_config
```

#### Рекомендуемые изменения:
- **Измените порт** (по умолчанию 22) на более высокий, чтобы уменьшить количество автоматических атак:

  ```plaintext
  Port 2222
  ```

- **Отключите вход по паролю** и используйте только ключи:

  ```plaintext
  PasswordAuthentication no
  ```

- **Отключите вход для пользователя root**:

  ```plaintext
  PermitRootLogin no
  ```

- **Настройте доступ для определенных пользователей или групп**:

  ```plaintext
  AllowUsers yourusername
  ```

- **Включите аутентификацию по ключу**:

  ```plaintext
  PubkeyAuthentication yes
  ```

- **Отключите анонимный доступ**:

  ```plaintext
  PermitEmptyPasswords no
  ```

#### Сохраните изменения и закройте редактор.

### 3. Генерация SSH-ключей
На клиентской машине сгенерируйте пару ключей, если у вас ее еще нет:

```bash
ssh-keygen -t rsa -b 4096
```

Скопируйте публичный ключ на сервер:

```bash
ssh-copy-id -i ~/.ssh/id_rsa.pub yourusername@yourserver_ip -p 2222
```

### 4. Перезапуск SSH-сервера
После внесения изменений в конфигурацию перезапустите SSH-сервер:

```bash
sudo systemctl restart ssh
```

### 5. Настройка брандмауэра
Убедитесь, что брандмауэр настроен правильно. Например, если вы изменили порт на 2222:

```bash
sudo ufw allow 2222/tcp
sudo ufw enable
```

### 6. Дополнительные меры безопасности
- **Установите Fail2Ban** для защиты от брутфорс-атак:

  ```bash
  sudo apt install fail2ban
  ```

- **Настройте двухфакторную аутентификацию** (например, с помощью Google Authenticator).

- **Регулярно обновляйте систему**:

  ```bash
  sudo apt update && sudo apt upgrade
  ```

### 7. Проверка состояния SSH
Убедитесь, что SSH работает и настроен правильно:

```bash
sudo systemctl status ssh
```
</details>

<details>
<summary><b>5. --TODO: WireGuard VPN.</b></summary>

<!-- TODO: WireGuard VPN. -->

![Image](/Task6/img/todo.png)

</details>