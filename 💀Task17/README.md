# –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å Docker –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–∑–∞ –≤—ã–ø–æ–ª–Ω–∏–º —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

### 0. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Docker

![img](/Cyb04-onl/üíÄTask17/img/docker-v.png)

### 1. –°–∫–∞—á–∞—Ç—å –æ–±—Ä–∞–∑ Ubuntu 18.04 —Å hub.docker.io

```sh
docker pull ubuntu:18.04
```



### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã –æ–±—Ä–∞–∑–∞ SHA256

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã –æ–±—Ä–∞–∑–∞, –≤—ã–ø–æ–ª–Ω–∏–º —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

```sh
docker image inspect ubuntu:18.04 --format '{{.RepoDigests}}'
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–æ–∫–∞–∂–µ—Ç —Ö–µ—à-—Å—É–º–º—É SHA256 –æ–±—Ä–∞–∑–∞. –í—ã –º–æ–∂–µ—Ç–µ —Å—Ä–∞–≤–Ω–∏—Ç—å –µ—ë —Å —Ö–µ—à-—Å—É–º–º–æ–π –Ω–∞ Docker Hub.

### 3. –û—Ç–æ–±—Ä–∞–∑–∏–º –≤—Å–µ Docker –æ–±—Ä–∞–∑—ã –≤ —Å–∏—Å—Ç–µ–º–µ

```sh
docker image ls
```

### 4. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É Docker

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥ Docker –±–µ–∑ sudo, –¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É Docker:

```sh
sudo usermod -aG docker $USER
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏–º–æ –≤—ã–π–¥–∏—Ç–∏ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∏ –≤–æ–π–¥–∏—Ç–µ —Å–Ω–æ–≤–∞, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø–∏–ª–∏ –≤ —Å–∏–ª—É.

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–∑ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ –≤ –æ–±–æ–ª–æ—á–∫–µ sh

```sh
docker run -it ubuntu:18.04 sh
```

### 6. –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É whoami –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sh
whoami
```

### 7. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º tms

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º `tms`, –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é Dockerfile –∏–ª–∏ –∫–æ–º–∞–Ω–¥—ã `docker run` —Å –æ–ø—Ü–∏–µ–π `--user`.

–°–æ–∑–¥–∞–¥–∏–º Dockerfile:

```Dockerfile
FROM ubuntu:18.04
RUN useradd -m tms
USER tms
CMD ["sh"]
```

–°–æ–±–µ—Ä–µ–º –æ–±—Ä–∞–∑:

```sh
docker build -t ubuntu-tms:18.04 .
```

–ó–∞–ø—É—Å—Ç–∏–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:

```sh
docker run -it ubuntu-tms:18.04
```

### 8. –ü—Ä–æ–≤–µ—Ä–∏–º –æ–±—Ä–∞–∑ —á–µ—Ä–µ–∑ —Å–∫–∞–Ω–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Trivy

–£—Å—Ç–∞–Ω–æ–≤–∏–º Trivy:

```sh
sudo apt-get install wget apt-transport-https gnupg lsb-release
wget -qO - https://aquasecurity.github.io/trivy-repo/deb/public.key | sudo apt-key add -
echo deb https://aquasecurity.github.io/trivy-repo/deb $(lsb_release -sc) main | sudo tee -a /etc/apt/sources.list.d/trivy.list
sudo apt-get update
sudo apt-get install trivy
```

–ü—Ä–æ—Å–∫–∞–Ω–∏—Ä—É–µ–º –æ–±—Ä–∞–∑:

```sh
trivy image ubuntu:18.04
```

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–±—Ä–∞–∑ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.