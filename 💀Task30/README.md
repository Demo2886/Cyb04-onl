
## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ WAF (Nginx + ModSecurity3)

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –°–µ—Ä–≤–µ—Ä Ubuntu 22.04.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å root.

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
apt update -y 
apt upgrade -y
apt install g++ flex bison curl apache2-dev doxygen libyajl-dev ssdeep liblua5.2-dev libgeoip-dev libtool dh-autoreconf libcurl4-gnutls-dev libxml2 libpcre++-dev libxml2-dev git liblmdb-dev libpkgconf3 lmdb-doc pkgconf zlib1g-dev libssl-dev -y
```

### –®–∞–≥ 2: –ö–æ–º–ø–∏–ª—è—Ü–∏—è ModSecurity3

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–∞–∫–µ—Ç ModSecurity –Ω–µ –≤–∫–ª—é—á–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Ubuntu –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ü–æ—ç—Ç–æ–º—É –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤.

```bash
wget https://github.com/SpiderLabs/ModSecurity/releases/download/v3.0.8/modsecurity-v3.0.8.tar.gz
```
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–≤–ª–µ–∫–∏—Ç–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
tar -xvzf modsecurity-v3.0.8.tar.gz
```
–î–∞–ª–µ–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –µ–≥–æ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
cd modsecurity-v3.0.8 
./build.sh 
./configure
```
–î–∞–ª–µ–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
make 
make install
```

### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ModSecurity 3

–î–∞–ª–µ–µ –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Nginx —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ModSecurity. –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä ModSecurity-nginx —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
cd ~
git clone https://github.com/SpiderLabs/ModSecurity-nginx.git
```
–ó–∞—Ç–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ Nginx —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
wget https://nginx.org/download/nginx-1.20.2.tar.gz
```
–î–∞–ª–µ–µ –∏–∑–≤–ª–µ–∫–∏—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ Nginx —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
tar xzf nginx-1.20.2.tar.gz
```
–î–∞–ª–µ–µ —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è Nginx —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
useradd -r -M -s /sbin/nologin -d /usr/local/nginx nginx
```
–î–∞–ª–µ–µ –∏–∑–º–µ–Ω–∏—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –Ω–∞ –∏—Å—Ö–æ–¥–Ω–∏–∫ Nginx –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –µ–µ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
cd nginx-1.20.2
./configure --user=nginx --group=nginx --with-pcre-jit --with-debug --with-compat --with-http_ssl_module --with-http_realip_module --add-dynamic-module=/root/ModSecurity-nginx --http-log-path=/var/log/nginx/access.log --error-log-path=/var/log/nginx/error.log
```
–î–∞–ª–µ–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
make
make modules
make install
```
–î–∞–ª–µ–µ —Å–æ–∑–¥–∞–π—Ç–µ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫—É—é —Å—Å—ã–ª–∫—É Nginx —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
ln -s /usr/local/nginx/sbin/nginx /usr/local/sbin/
```
–î–∞–ª–µ–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é Nginx —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
nginx -v
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx —Å –ø–æ–º–æ—â—å—é ModSecurity
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
cp ~/modsecurity-v3.0.8/modsecurity.conf-recommended /usr/local/nginx/conf/modsecurity.conf
cp ~/modsecurity-v3.0.8/unicode.mapping /usr/local/nginx/conf/
```
–î–∞–ª–µ–µ —Å–¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx:

```bash
cp /usr/local/nginx/conf/nginx.conf{,.bak}
```
–î–∞–ª–µ–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx:

```bash
nano /usr/local/nginx/conf/nginx.conf
```
–£–¥–∞–ª–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:

```bash
load_module modules/ngx_http_modsecurity_module.so;
user  nginx;
worker_processes  1;
pid        /run/nginx.pid;
events {
    worker_connections  1024;
}
http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;
    server {
        listen       80;
        server_name  nginx.example.com;
        modsecurity  on;
        modsecurity_rules_file  /usr/local/nginx/conf/modsecurity.conf;
        access_log  /var/log/nginx/access_example.log;
        error_log  /var/log/nginx/error_example.log;
        location / {
            root   html;
            index  index.html index.htm;
        }
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }
}
```
–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –∑–∞–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª, –∑–∞—Ç–µ–º –≤–∫–ª—é—á–∏—Ç–µ ModSecurity —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
sed -i 's/SecRuleEngine DetectionOnly/SecRuleEngine On/' /usr/local/nginx/conf/modsecurity.conf
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª ModSecurity
–ù–∞–±–æ—Ä –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª OWASP ModSecurity –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ –∑–∞—â–∏—Ç—ã –æ—Ç —à–∏—Ä–æ–∫–æ–≥–æ —Å–ø–µ–∫—Ç—Ä–∞ –∞—Ç–∞–∫, –≤–∫–ª—é—á–∞—è –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–µ—Å—è—Ç–∫—É –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π OWASP.
–°–Ω–∞—á–∞–ª–∞ —Å–∫–∞—á–∞–π—Ç–µ –Ω–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª OWASP —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
cd ~
git clone https://github.com/SpiderLabs/owasp-modsecurity-crs.git /usr/local/nginx/conf/owasp-crs
```
–ó–∞—Ç–µ–º –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ crs-setup.conf.example –≤ —Ñ–∞–π–ª crs-setup.conf:

```bash
cp /usr/local/nginx/conf/owasp-crs/crs-setup.conf{.example,}
```
–î–∞–ª–µ–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
echo -e "Include owasp-crs/crs-setup.conf
Include owasp-crs/rules/*.conf" >> /usr/local/nginx/conf/modsecurity.conf
```
–ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ Nginx –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
nginx -t
```
–ï—Å–ª–∏ –≤—Å–µ –≤ –ø–æ—Ä—è–¥–∫–µ, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –≤—ã–≤–æ–¥:

```bash
nginx: the configuration file /usr/local/nginx/conf/nginx.conf syntax is ok
nginx: configuration file /usr/local/nginx/conf/nginx.conf test is successful
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ systemd –¥–ª—è nginx

–î–∞–ª–µ–µ –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å–µ—Ä–≤–∏—Å–∞ systemd –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–º Nginx. –ß—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å Nginx —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—ã. –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
nano /etc/systemd/system/nginx.service
```
–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:

```bash
[Unit]
Description=A high performance web server and a reverse proxy server
Documentation=man:nginx(8)
After=network.target nss-lookup.target

[Service]
Type=forking
PIDFile=/run/nginx.pid
ExecStartPre=/usr/local/nginx/sbin/nginx -t -q -g 'daemon on; master_process on;'
ExecStart=/usr/local/nginx/sbin/nginx -g 'daemon on; master_process on;'
ExecReload=/usr/local/nginx/sbin/nginx -g 'daemon on; master_process on;' -s reload
ExecStop=-/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid
TimeoutStopSec=5
KillMode=mixed

[Install]
WantedBy=multi-user.target
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –∑–∞–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
systemctl daemon-reload
systemctl start nginx
systemctl enable nginx
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã Nginx —Å ModSecurity
–î–∞–ª–µ–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å Nginx —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

```bash
curl localhost?doc=/bin/ls
```
–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∂—É—Ä–Ω–∞–ª –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Mode, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:    

```bash
tail /var/log/modsec_audit.log
```

![img](/üíÄTask30/img/waf.png)
![img](/üíÄTask30/img/test.png)

### –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –≤—ã —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ ModSecurity —Å Nginx –Ω–∞ Ubuntu 22.04. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–Ω–µ–¥—Ä–∏—Ç—å ModSecurity –≤ —Å–≤–æ—é –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ä–µ–¥—É –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç DDoS-–∞—Ç–∞–∫. –ù–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å –º–µ–Ω—è, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∫–∞–∫–∏–µ-–ª–∏–±–æ –≤–æ–ø—Ä–æ—Å—ã.



### –í—ã–∑–æ–≤–∏—Ç–µ 5 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ä–∞–±–æ—Ç–æ–∫ WAF –ü—Ä–∞–≤–∏–ª–∞, –ø—Ä–∏–º–µ–Ω—è—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —É—è–∑–≤–∏–º—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.

```bash
docker run -d -p 8080:80 saurav7055/xvwa
```

![img](/üíÄTask30/img/XVWA.png)



###  **SQL-–∏–Ω—ä–µ–∫—Ü–∏—è (SQL Injection)**

**–û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏**: SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –¥–æ–ª–∂–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã.

**–ü—Ä–∏–º–µ—Ä –∞—Ç–∞–∫–∏**:
```sql
35.228.67.180/login?username=' OR 1=1 --&password=test
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –í–≤–µ–¥—ë–Ω–Ω—ã–π –∫–æ–¥ `' OR 1=1 --` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–æ–π—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, —Ç–∞–∫ –∫–∞–∫ —É—Å–ª–æ–≤–∏–µ `OR 1=1` –≤—Å–µ–≥–¥–∞ –∏—Å—Ç–∏–Ω–Ω–æ.

**–°—Ä–∞–±–æ—Ç–∫–∞ WAF**: WAF —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã SQL-–∏–Ω—ä–µ–∫—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `' OR`, '--' ) –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å.

![img](/üíÄTask30/img/SQLin.png)

###  **XSS (–ú–µ–∂—Å–∞–π—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç–∏–Ω–≥, Cross-Site Scripting)**

**–û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏**: XSS-–∞—Ç–∞–∫–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –≤–Ω–µ–¥—Ä–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π JavaScript-–∫–æ–¥ –≤ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—É, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ç–µ–º –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —É –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–ü—Ä–∏–º–µ—Ä –∞—Ç–∞–∫–∏**:
```html
35.228.67.180/search?q=<script>alert('XSS')</script>
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π JavaScript –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∫—Ä–∞–∂–µ cookies, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –Ω–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Å–∞–π—Ç—ã –∏ –¥—Ä—É–≥–∏–º –∞—Ç–∞–∫–∞–º.

**–°—Ä–∞–±–æ—Ç–∫–∞ WAF**: WAF –æ–±–Ω–∞—Ä—É–∂–∏—Ç –ø–æ–ø—ã—Ç–∫—É –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ (—Ç–µ–≥–∏ `<script>`, —Ñ—É–Ω–∫—Ü–∏—è `alert()` –∏ —Ç.–¥.) –∏ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å.

![img](/üíÄTask30/img/XSS.png)

###  **–ö–æ–º–∞–Ω–¥–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è (Command Injection)**

**–û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏**: –ö–æ–º–∞–Ω–¥–Ω–∞—è –∏–Ω—ä–µ–∫—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –Ω–∞–ø—Ä—è–º—É—é –≤ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –±–µ–∑ –¥–æ–ª–∂–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

**–ü—Ä–∏–º–µ—Ä –∞—Ç–∞–∫–∏**:
```bash
35.228.67.180/data?file=report.txt;ls -la;
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `ls -la`, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

**–°—Ä–∞–±–æ—Ç–∫–∞ WAF**: WAF –æ–±–Ω–∞—Ä—É–∂–∏—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `;` –∏ –∫–æ–º–∞–Ω–¥—ã –æ–±–æ–ª–æ—á–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ls`), –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞.

![img](/üíÄTask30/img/CI.png)

###  **LFI (Local File Inclusion)**

**–û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏**: LFI –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∏—Å–ø–æ–ª—å–∑—É—è —É—è–∑–≤–∏–º—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –≤ –ø—É—Ç—è—Ö –∫ —Ñ–∞–π–ª–∞–º.

**–ü—Ä–∏–º–µ—Ä –∞—Ç–∞–∫–∏**:
```bash
35.228.67.180/page?file=../../../../etc/passwd
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–º—É —Ñ–∞–π–ª—É `/etc/passwd`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö —Å–∏—Å—Ç–µ–º—ã.

**–°—Ä–∞–±–æ—Ç–∫–∞ WAF**: WAF –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è LFI-–∞—Ç–∞–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `../`) –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å.

![img](/üíÄTask30/img/LFI.png)

