# –£—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏ –∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. 

### 1. –°–æ–∑–¥–∞—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
```powershell
# –°–æ–∑–¥–∞—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
$adminUsername = "AdminDemo"
$adminPassword = "P@ssw0rd123!" | ConvertTo-SecureString -AsPlainText -Force
New-LocalUser -Name $adminUsername -Password $adminPassword -FullName "Admin Demo" -Description "Administrator account" -PasswordNeverExpires:$true
Add-LocalGroupMember -Group "Administrators" -Member $adminUsername
```
![img](/üíÄTask13/img/addNewAdminUser.png)
![img](/üíÄTask13/img/AdminDemo.png)

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è –∏ –∑–∞–ø–∏—Å–∞—Ç—å –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
### 2.1 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è
```powershell
$adminUsername = "AdminDemo"
$adminPassword = "SimpleP@ssw0rd"
```
### 2.2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
```powershell
$securePassword = ConvertTo-SecureString $adminPassword -AsPlainText -Force
```
### 2.3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```powershell
Set-LocalUser -Name $adminUsername -Password $securePassword
```
### 2.4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
```powershell
$credentialTarget = "AdminDemo_Credentials" # –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
$null = cmdkey /add:$credentialTarget /user:$adminUsername /pass:$adminPassword
```
### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```powershell
Write-Host "–ü–∞—Ä–æ–ª—å —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ '$adminUsername' –æ–±–Ω–æ–≤–ª–µ–Ω."
Write-Host "–ü–∞—Ä–æ–ª—å: $adminPassword"
```
![img](/üíÄTask13/img/updatePass.png)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```powershell
cmdkey /list
```

![img](/üíÄTask13/img/setLitCred.png)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ï—Å–ª–∏ –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**:
   - –ù–∞–∂–º–∏—Ç–µ `Win + R`, –≤–≤–µ–¥–∏—Ç–µ `control`, –∏ –Ω–∞–∂–º–∏—Ç–µ Enter.

2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"**:
   - –í –ü–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–±–µ—Ä–∏—Ç–µ **"–£—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"**.
   - –ó–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏—Ç–µ **"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"**.

3. **–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:
   - –í —Ä–∞–∑–¥–µ–ª–µ **"–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ Windows"** –≤—ã —É–≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ò—â–∏—Ç–µ –∑–∞–ø–∏—Å—å —Å –∏–º–µ–Ω–µ–º `AdminDemo_Credentials` –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.

![img](/üíÄTask13/img/AdminDemo.png)

### 3. –û—Ç–∫–ª—é—á–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å ¬´–ì–æ—Å—Ç—å¬ª
```powershell
# –û—Ç–∫–ª—é—á–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å ¬´–ì–æ—Å—Ç—å¬ª
Set-LocalUser -Name "Guest" -AccountDisabled $true
Get-LocalUser -Name "Guest" | Select-Object Name, Enabled
```
![img](/üíÄTask13/img/enableGuest.png)

### 4. –í–∫–ª—é—á–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (UAC)
–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Ä–æ–≤–Ω—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π UAC –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ–µ—Å—Ç—Ä —á–µ—Ä–µ–∑ PowerShell:
```powershell
# –í–∫–ª—é—á–∏—Ç—å UAC –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "EnableLUA" -Value 1
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "ConsentPromptBehaviorAdmin" -Value 5
```
![img](/üíÄTask13/img/UAC.png)

### –°–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è:

```powershell
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ Windows Server 2019

# 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–∞—Ä–æ–ª–µ–π
function Configure-PasswordPolicy {
    # –í–µ—Å—Ç–∏ –∂—É—Ä–Ω–∞–ª –ø–∞—Ä–æ–ª–µ–π - 5 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–∞—Ä–æ–ª–µ–π
    secedit /export /cfg C:\work\secpol.cfg
    (Get-Content C:\work\secpol.cfg).replace('PasswordHistorySize = 24', 'PasswordHistorySize = 5') | Set-Content C:\work\secpol.cfg
    secedit /configure /db secedit.sdb /cfg C:\work\secpol.cfg /quiet

    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª–µ–π - 90 –¥–Ω–µ–π
    net accounts /maxpwage:90

    # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è - 8 —Å–∏–º–≤–æ–ª–æ–≤
    net accounts /minpwlen:8

    # –ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ - –í–∫–ª—é—á–µ–Ω
    secedit /export /cfg C:\work\secpol.cfg
    (Get-Content C:\work\secpol.cfg).replace('PasswordComplexity = 0', 'PasswordComplexity = 1') | Set-Content C:\work\secpol.cfg
    secedit /configure /db secedit.sdb /cfg C:\work\secpol.cfg /quiet

    Write-Host "–ü–æ–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞"
}

# 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏
function Configure-LockoutPolicy {
    # –ü–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ - 5 –æ—à–∏–±–æ–∫
    net accounts /lockoutthreshold:5

    # –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –£–ó - 15 –º–∏–Ω
    net accounts /lockoutduration:15

    # –†–∞–∑—Ä–µ—à–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –£–ó –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ - –í–∫–ª—é—á–µ–Ω–æ
    secedit /export /cfg C:\work\secpol.cfg
    (Get-Content C:\work\secpol.cfg).replace('LockoutBadCount = 0', 'LockoutBadCount = 1') | Set-Content C:\work\secpol.cfg
    secedit /configure /db secedit.sdb /cfg C:\work\secpol.cfg /quiet

    Write-Host "–ü–æ–ª–∏—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞"
}

# –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç

# 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –ø–∞—Ä–æ–ª–µ–π
Configure-PasswordPolicy

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏
Configure-LockoutPolicy

Write-Host "–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ"
```

### –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫:

1. **–ü–æ–ª–∏—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π**:
   - –í–µ—Å—Ç–∏ –∂—É—Ä–Ω–∞–ª –ø–∞—Ä–æ–ª–µ–π (5 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–∞—Ä–æ–ª–µ–π) ‚Äî —ç—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –ø–∞—Ä–æ–ª–µ–π.
   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Ä–æ–ª–µ–π ‚Äî 90 –¥–Ω–µ–π.
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è ‚Äî 8 —Å–∏–º–≤–æ–ª–æ–≤.
   - –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è –≤–∫–ª—é—á–µ–Ω—ã.

2. **–ü–æ–ª–∏—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏**:
   - –ü–æ—Ä–æ–≥ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ—Å–ª–µ 5 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞.
   - –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ ‚Äî 15 –º–∏–Ω—É—Ç.
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤–∫–ª—é—á–µ–Ω–∞.

### –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç:

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ —Ñ–∞–π–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä, `security_policy.ps1`.
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PowerShell —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞:
   ```powershell
   .\security_policy.ps1
   ```
![img](/üíÄTask13/img/PasswordPolicy.png)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

![img](/üíÄTask13/img/wfLog.png)
