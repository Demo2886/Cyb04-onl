## –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞ ClamAV –∏ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –æ–±–æ–ª–æ—á–∫–∏, –∞ —Ç–∞–∫–∂–µ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ClamAV

1. **–û–±–Ω–æ–≤–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤**:
   ```bash
   sudo apt update
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ClamAV**:
   ```bash
   sudo apt install clamav clamtk
   ```

   –ó–¥–µ—Å—å `clamav` ‚Äî —ç—Ç–æ —Å–∞–º –∞–Ω—Ç–∏–≤–∏—Ä—É—Å, –∞ `clamtk` ‚Äî –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –æ–±–æ–ª–æ—á–∫–∞ –¥–ª—è –Ω–µ–≥–æ.

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª—É–∂–±—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
```bash
sudo systemctl stop clamav-freshclam
```

### –ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
```bash
sudo freshclam
```

![img](/üíÄTask19/img/update-clam.png)

### –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
```bash
sudo systemctl start clamav-freshclam
```
![img](/üíÄTask19/img/status-clam.png)

### –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é –æ–±–æ–ª–æ—á–∫—É ClamTK**:
   ```bash
   clamtk
   ```

2. –í –æ—Ç–∫—Ä—ã–≤—à–µ–º—Å—è –æ–∫–Ω–µ –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (–æ–±—ã—á–Ω–æ —ç—Ç–æ –∫–Ω–æ–ø–∫–∞ "–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–∞–ª–æ–≥" –∏–ª–∏ "Scan a directory").

3. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ –Ω–∞—á–Ω–∏—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ.

### –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:
```bash
clamscan -r -i /–ø—É—Ç—å/–∫/–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
```
![img](/üíÄTask19/img/scan-clam.png)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–¥–∏–Ω —Ñ–∞–π–ª, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:
```bash
clamscan –æ–ø—Ü–∏–∏ /–ø—É—Ç—å/–∫/–ø–∞–ø–∫–µ/–∏–ª–∏/—Ñ–∞–π–ª—É
```
### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ClamAV –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ —Å –ø–æ–º–æ—â—å—é —ç—Ç–∏—Ö –æ–ø—Ü–∏–π:

    -V, --version - –≤—ã–≤–µ—Å—Ç–∏ –≤–µ—Ä—Å–∏—é –ø—Ä–æ–≥—Ä–∞–º–º—ã;
    -v, --verbose - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥;
    -a, --archive-verbose - –≤—ã–≤–æ–¥–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã—Ö —Ñ–∞–π–ª–∞—Ö –≤–Ω—É—Ç—Ä–∏ –∞—Ä—Ö–∏–≤–æ–≤;
    --debug - –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è;
    --quiet - –≤—ã–≤–æ–¥–∏—Ç—å –º–∏–Ω–∏–º—É–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏;
    --no-summary - –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è;
    -i, --infected - –≤—ã–≤–æ–¥–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç–æ–ª—å–∫–æ –æ–± –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö;
    --bell - –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –∑–≤—É–∫–æ–≤–æ–π —Å–∏–≥–Ω–∞–ª –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –≤–∏—Ä—É—Å–∞;
    -d, --database - –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏—Ä—É—Å–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞;
    -l, --log - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ñ–∞–π–ª;
    -r, --recursive - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π;
    --move - –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –ø–∞–ø–∫—É;
    --copy - –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –ø–∞–ø–∫—É;
    --exclude, --exclude-dir - –Ω–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏, –∏–º–µ–Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–¥–ø–∞–¥–∞—é—Ç –ø–æ–¥ —à–∞–±–ª–æ–Ω;
    --remove - —É–¥–∞–ª—è—Ç—å –≤—Å–µ –∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã;
    --scan-pe=yes/no - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã Windows, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ;
    --scan-elf=yes/no - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã Linux, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ;
    --scan-ole2=yes/no - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã Office, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ;
    --scan-archive=yes/no - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤—ã, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ;
    --max-filesize - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö, –∏–∑–≤–ª–µ–∫–∞–µ–º—ã—Ö –∏–∑ –∞—Ä—Ö–∏–≤–∞, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 25 –ú–±;
    --max-files - –∏–∑–≤–ª–µ–∫–∞—Ç—å –Ω–µ –±–æ–ª—å—à–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤ –∏–∑ —Å–∫–∞–Ω–∏—Ä—É–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ (–∞—Ä—Ö–∏–≤—ã, –¥–æ–∫—É–º–µ–Ω—Ç—ã, –ª—é–±–æ–π –≤–∏–¥ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤), –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000;
    --max-recursion - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–ø–æ–∫ –≤ –∞—Ä—Ö–∏–≤–µ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 16;
    --max-dir-recursion - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–ø–æ–∫ –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 15.



## –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ YARA, —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –µ–≥–æ —Ö–µ—à–∞ –∏ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏.

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ YARA

1. **–û–±–Ω–æ–≤–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤**:
   ```bash
   sudo apt update
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ YARA**:
   ```bash
   sudo apt install yara
   ```

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –µ–≥–æ —Ö–µ—à–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª**:
   ```bash
   echo "–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è YARA." > test_file.txt
   ```

2. **–í—ã—á–∏—Å–ª–∏—Ç–µ —Ö–µ—à —Ñ–∞–π–ª–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SHA256):
   ```bash
   sha256sum test_file.txt
   ```

   –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ö–µ—à, –æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª–∞.

### –ù–∞–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ YARA**:
   ```bash
   nano my_rules.yara
   ```

2. **–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ**. –ù–∞–ø—Ä–∏–º–µ—Ä:
   ```yara
   rule DetectTestFile {
       meta:
           description = "–ü—Ä–∞–≤–∏–ª–æ –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞"
           author = "–í–∞—à–µ –∏–º—è"
           date = "2024-10-08"

       strings:
           $text_string = "–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è YARA."

       condition:
           $text_string
   }
   ```

   –ó–¥–µ—Å—å —Å—Ç—Ä–æ–∫–∞ `$text_string` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç –∏–∑ –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞.

3. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –∏ –≤—ã–π–¥–∏—Ç–µ –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞** (–≤ nano: –Ω–∞–∂–º–∏—Ç–µ `Ctrl + O`, –∑–∞—Ç–µ–º `Enter`, –∏ `Ctrl + X`).

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ YARA –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∞–π–ª–∞**:
   ```bash
   yara my_rules.yara test_file.txt
   ```

–ï—Å–ª–∏ –ø—Ä–∞–≤–∏–ª–æ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—ã —É–≤–∏–¥–∏—Ç–µ –∏–º—è –ø—Ä–∞–≤–∏–ª–∞ (`DetectTestFile`).

![img](/üíÄTask19/img/yara.png)